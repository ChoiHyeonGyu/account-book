<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="option">

	<select id="add0" parameterType="string" resultType="string">
		<![CDATA[
			select category from category where category=#{category}
		]]>
	</select>
	
	<insert id="add" parameterType="optionvo" >
		<![CDATA[
			insert into category values(seq_category.nextval, #{category}, 0)
		]]>
	</insert>
	
	<select id="add1" parameterType="optionvo" resultType="int">
		<![CDATA[
			select category_id as categoryId from category where category=#{category}
		]]>
	</select>
	
	<insert id="add2" parameterType="optionvo">
		<![CDATA[
			insert into userscategory values(#{id}, #{categoryId}, '0')
		]]>
	</insert>
	
	<select id="checkPassword" parameterType="string" resultType="string">
		<![CDATA[
			select password from users where id=#{value}
		]]>
	</select>

	<select id="limitModify" parameterType="optionvo" resultType="int">
		<![CDATA[
			select category_id as categoryId from category where category=#{category}
		]]>
	</select>
	
	<update id="limitModify1" parameterType="optionvo">
		<![CDATA[
			update userscategory set money_limit=#{limit}
 			 where category_id=#{categoryId} 	 	
 	 	]]>
	</update>

	<select id="categoryModify" parameterType="int" resultType="optionvo">
 		<![CDATA[
 			select category_id as categoryId, category from category where category_id=#{categoryId}
 		]]>
	</select>
	
	<update id="categoryModify1" parameterType="optionvo">
 		<![CDATA[
		update category set category=#{category}
 		 where category_id=#{categoryId} 	 	
 	 	]]>
	</update>

	<select id="category" parameterType="optionvo" resultType="optionvo">
		<![CDATA[
			select category.category, count(list.category) as postCount, category.category_id as categoryId, userscategory.money_limit as limit
			from users
			left outer join userscategory
			on users.id=userscategory.id and users.id=#{id}
			left outer join category
			on userscategory.category_id=category.category_id
			left outer join list
			on (category.category = list.category) where category.category is not NULL
			group by category.category, category.category_id, userscategory.money_limit
			order by category.category
 		]]>
	</select>

	<delete id="delete" parameterType="optionvo">
		<![CDATA[
					delete from userscategory where category_id = #{categoryId}

			]]>
	</delete>
	
	<delete id="resetlist" parameterType="string">
		<![CDATA[
					delete from userscategory where id = #{value}

			]]>
	</delete>
	
	<delete id="resetcategory" parameterType="string">
		<![CDATA[
					delete from list where id = #{value}

			]]>
	</delete>

</mapper>

